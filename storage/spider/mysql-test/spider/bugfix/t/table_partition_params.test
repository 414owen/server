--echo
--echo Testing spider table and partition level param overriding
--echo

--disable_query_log
--disable_result_log
--source ../../t/test_init.inc
--enable_result_log
--enable_query_log

--connection master_1
SET @old_spider_read_only_mode = @@session.spider_read_only_mode;
set session spider_read_only_mode = 0;
CREATE DATABASE auto_test_local;
USE auto_test_local;

--connection child2_1
CREATE DATABASE auto_test_remote;
USE auto_test_remote;
eval CREATE TABLE t2 (
  a INT
) $CHILD2_1_ENGINE $CHILD2_1_CHARSET;

--connection child2_2
CREATE DATABASE auto_test_remote2;
USE auto_test_remote2;
eval CREATE TABLE t2 (
  a INT
) $CHILD2_1_ENGINE $CHILD2_1_CHARSET;

--connection master_1
eval CREATE TABLE t1 (
  a INT
) $MASTER_1_ENGINE $MASTER_1_CHARSET
COMMENT='tbl "t2", read_only_mode "1", srv "s_2_1"'
PARTITION BY RANGE (a) (
    PARTITION p1 VALUES LESS THAN (3),
    PARTITION p2 VALUES LESS THAN MAXVALUE COMMENT='srv "s_2_2", read_only_mode "0"'
);

--error 12518
insert into t1 values (2);
insert into t1 values (42);

--connection child2_1
DROP DATABASE auto_test_remote;

--connection child2_2
DROP DATABASE auto_test_remote2;

--connection master_1
DROP DATABASE auto_test_local;
SET session spider_read_only_mode = @old_spider_read_only_mode;

--disable_query_log
--disable_result_log
--source ../../t/test_deinit.inc
--enable_result_log
--enable_query_log

--echo #
--echo # End of test sysvar_params
--echo #
