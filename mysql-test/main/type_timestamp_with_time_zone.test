#
# We don't have a full functional TIMESTAMP WITH TIME ZONE yet.
# Only some basic functionality (e.g. inside literals).
#

SET time_zone='+02:00';

SELECT TIMESTAMP'2001-01-01 10:00:00Z';
EXPLAIN EXTENDED SELECT TIMESTAMP'2001-01-01 00:00:00Z' AS a;

SELECT TIMESTAMP'2038-01-19 03:14:07Z';
--error ER_WRONG_VALUE
SELECT TIMESTAMP'2038-01-19 03:14:08Z';
--error ER_WRONG_VALUE
SELECT TIMESTAMP'9999-01-01 00:00:00Z';


SELECT CAST(TIMESTAMP'2001-01-01 10:00:00Z' AS DATETIME) AS c1,
       CAST(COALESCE(TIMESTAMP'2001-01-01 10:00:00Z') AS DATETIME) AS c2;


CREATE TABLE t1 (id INT NOT NULL PRIMARY KEY, ts TIMESTAMP);
INSERT INTO t1 VALUES (1, '2001-01-01 10:00:00');
INSERT INTO t1 VALUES (2, '2001-01-01 10:00:00Z');
SELECT * FROM t1;
SELECT * FROM t1 WHERE ts='2001-01-01 10:00:00';
SELECT * FROM t1 WHERE ts='2001-01-01 10:00:00Z';
EXPLAIN EXTENDED SELECT * FROM t1 WHERE ts='2001-01-01 10:00:00Z';
DROP TABLE t1;

CREATE TABLE t1 (
  id INT NOT NULL PRIMARY KEY,
  ts TIMESTAMP DEFAULT (COALESCE(TIMESTAMP'2001-01-01 10:00:00Z'))
);
SHOW CREATE TABLE t1;
CREATE VIEW v1 AS
SELECT id, ts, COALESCE(ts, TIMESTAMP'2001-01-01 10:00:00Z') AS ts2
FROM t1;
SHOW CREATE VIEW v1;
DROP VIEW v1;
DROP TABLE t1;

CREATE TABLE t1 (
  ts TIMESTAMP,
  ts2 TIMESTAMP AS (COALESCE(ts, TIMESTAMP'2001-01-01 10:00:00Z'))
);
SHOW CREATE TABLE t1;
DROP TABLE t1;


CREATE TABLE t1 (id INT NOT NULL PRIMARY KEY, dt DATETIME);
INSERT INTO t1 VALUES (1, '2001-01-01 10:00:00');
INSERT INTO t1 VALUES (2, '2001-01-01 10:00:00Z');
SELECT * FROM t1;
SELECT * FROM t1 WHERE dt='2001-01-01 10:00:00';
SELECT * FROM t1 WHERE dt='2001-01-01 10:00:00Z';
EXPLAIN EXTENDED SELECT * FROM t1 WHERE dt='2001-01-01 10:00:00Z';
DROP TABLE t1;


SELECT TIMESTAMP'2001-01-01 10:00:00Z' AS c1,
       COALESCE(TIMESTAMP'2001-01-01 10:00:00Z') AS c2;
CREATE TABLE t1 AS
SELECT TIMESTAMP'2001-01-01 10:00:00Z' AS c1,
  COALESCE(TIMESTAMP'2001-01-01 10:00:00Z') AS c2;
SHOW CREATE TABLE t1;
SELECT * FROM t1;
DROP TABLE t1;



# TODO
# - SQL standard Time Zone Intervals in addition to UTC 'Z':
#     '2001-01-01 10:10:10+02:00'
# - An additional constructor Item_timestamp_literal() to get
#   a Timestamp value instead of Timestamp_or_zero_datetime
# - Disallow spaces between TIME and 'Z'
